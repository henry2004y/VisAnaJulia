<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parker Spiral · SpaceAnalysis</title><link rel="canonical" href="https://henry2004y.github.io/VisAnaJulia/man/parker_spiral/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">SpaceAnalysis</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../examples/">Example</a></li><li><a class="tocitem" href="../log/">Log</a></li><li class="is-active"><a class="tocitem" href>Parker Spiral</a></li><li><a class="tocitem" href="../internal/">Internal</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Parker Spiral</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parker Spiral</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/henry2004y/VisAnaJulia/blob/master/docs/src/man/parker_spiral.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Interplanetary-Magnetic-Field"><a class="docs-heading-anchor" href="#Interplanetary-Magnetic-Field">Interplanetary Magnetic Field</a><a id="Interplanetary-Magnetic-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Interplanetary-Magnetic-Field" title="Permalink"></a></h1><p>The <a href="https://en.wikipedia.org/wiki/Interplanetary_magnetic_field">interplanetary magnetic field</a> (IMF), also called Parker spiral, is the component of the solar magnetic field that is dragged out from the solar corona by the solar wind flow to fill the Solar System. Depending on the polarity of the photospheric footpoint, the heliospheric magnetic field spirals inward or outward; the magnetic field follows the same shape of spiral in the northern and southern parts of the heliosphere, but with opposite field direction. These two magnetic domains are separated by a current sheet (an electric current that is confined to a curved plane). This heliospheric current sheet has a shape similar to a twirled ballerina skirt, and changes in shape through the solar cycle as the Sun&#39;s magnetic field reverses about every 11 years. </p><p>References:</p><ol><li><a href="https://farside.ph.utexas.edu/teaching/plasma/lectures1/node68.html">Richard Fitzpatrick</a></li><li><a href="https://demonstrations.wolfram.com/TheInterplanetaryMagneticFieldParkerSpiral/">Mathematica</a><sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></li></ol><pre><code class="language-julia">using PyPlot

# Solar
const Tsolarrotate = 25.05*24*3600 # [s]
const ωsun = 2π / Tsolarrotate # [rad/s]
const Rsun = 696340e3 # solar radius, [m]
const AU = 1.496e11 # sun-Earth distance, [m]

# Distance from sun
# https://www.enchantedlearning.com/subjects/astronomy/planets/
const dMercury = 0.39  # [AU], 57.91e9 [m]
const dVenus   = 0.723 # [AU], 108.2e9 [m]
const dMars    = 1.524 # [AU], 227.9e9 [m]
const dJupiter = 5.203 # [AU], 778.5e9 [m]
const dSaturn  = 9.539 # [AU], 1434e9  [m]
const dUranus  = 19.18 # [AU], 2871e9  [m]
const dNeptune = 30.06 # [AU], 4495e9  [m]

const Vr = 300e3 # [m/s]
const rmin = 1.0*Rsun # inner radius, [m]
const rmax = 5.3*AU # outer radius, [m]

# 2D ecliptic plane
φ₀ = 0
r = range(rmin, rmax, length=300)
φ = @. 2π *( φ₀ + rmin*ωsun/Vr*(r/rmin - log(r) - 1 + log(rmin)) )

fig = figure(&quot;Ecliptic plane&quot;,figsize=(10,10))
ax = PyPlot.axes(polar=&quot;true&quot;)
ax.plot(φ, r./AU, label=&quot;Parker spiral&quot;)

rCircle = ones(100)
angle = range(0, 2π, length=100)

ax.plot(angle, rCircle, &quot;k--&quot;, label=&quot;Earth&quot;)
ax.plot(angle, rCircle.*dMercury, &quot;--&quot;, label=&quot;Mercury&quot;)
ax.plot(angle, rCircle.*dVenus, &quot;--&quot;, label=&quot;Venus&quot;)
ax.plot(angle, rCircle.*dMars, &quot;--&quot;, label=&quot;Mars&quot;)
ax.plot(angle, rCircle.*dJupiter, &quot;--&quot;, label=&quot;Jupiter&quot;)

ax.set_rmax(rmax/AU)
ax.set_rlabel_position(-22.5)  # Move radial labels away from plotted line
ax.grid(true)
legend()

ax.set_title(&quot;Interplanetary Magnetic Field In the Ecliptic Plane&quot;, va=&quot;bottom&quot;)

show()</code></pre><pre><code class="language-julia"># 3D
nr, nθ = 10, 50
r_range = range(rmin, rmax, length=nr)
θ_range = range(π/16, π*15/16, length=nθ)

# meshgrid like operation
r = r_range&#39; .* ones(nθ)
θ = ones(nr)&#39; .* θ_range

fig = plt.figure(&quot;3D&quot;, figsize=(10,6))
using3D()
ax = fig.gca(projection=&quot;3d&quot;)

for i = 1:1
   local φ₀ = i*π/4
   local φ = @. 2π *( φ₀ + rmin*ωsun/Vr*(r/rmin - log(r) - 1 + log(rmin)) )

   X = @. r * sin(θ) * cos(φ) / AU
   Y = @. r * sin(θ) * sin(φ) / AU
   Z = @. r * cos(θ) / AU

   ax.scatter(X, Y, Z)
   #ax.plot_surface(X, Y, Z, alpha=0.3)
end

xlabel(&quot;x [AU]&quot;)
ylabel(&quot;y [AU]&quot;)
zlabel(&quot;z [AU]&quot;)

show()</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>many equations in the Mathematic page assume that θ=π/2, so that sin(θ) term is missing!</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../log/">« Log</a><a class="docs-footer-nextpage" href="../internal/">Internal »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 4 May 2021 13:35">Tuesday 4 May 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
