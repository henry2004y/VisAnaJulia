<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Streamline and Trajectory · VisAna</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">VisAna</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">VisAna.jl Documentation</a></li><li><a class="tocitem" href="../analysis/">Data Analysis in Space Physics</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../log/">Development Log</a></li><li><a class="tocitem" href="../testparticle/">Test Particle Simulation</a></li><li><a class="tocitem" href="../text/">Text Data Processing</a></li><li class="is-active"><a class="tocitem" href>Streamline and Trajectory</a><ul class="internal"><li><a class="tocitem" href="#Streamline-Tracing"><span>Streamline Tracing</span></a></li><li><a class="tocitem" href="#Particle-Tracing"><span>Particle Tracing</span></a></li></ul></li><li><a class="tocitem" href="../types/">Public types</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Streamline and Trajectory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Streamline and Trajectory</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/henry2004y/VisAnaJulia/blob/master/docs/src/man/trace.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Streamline-and-Trajectory"><a class="docs-heading-anchor" href="#Streamline-and-Trajectory">Streamline and Trajectory</a><a id="Streamline-and-Trajectory-1"></a><a class="docs-heading-anchor-permalink" href="#Streamline-and-Trajectory" title="Permalink"></a></h1><p>Streamline and trajectory are related topics in physical modeling, common seen in fluid and particle simulations. In the future, the stream tracing should become a stand-alone package!</p><h2 id="Streamline-Tracing"><a class="docs-heading-anchor" href="#Streamline-Tracing">Streamline Tracing</a><a id="Streamline-Tracing-1"></a><a class="docs-heading-anchor-permalink" href="#Streamline-Tracing" title="Permalink"></a></h2><p>First make it work, then make it better and fast.</p><p>I found an approach called Pollock method.</p><p>I need an adaptive step control integration scheme like rk45.</p><h3 id="Tracing-on-Unstructured-Grid"><a class="docs-heading-anchor" href="#Tracing-on-Unstructured-Grid">Tracing on Unstructured Grid</a><a id="Tracing-on-Unstructured-Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Tracing-on-Unstructured-Grid" title="Permalink"></a></h3><p>Given an unstructured grid with node points and connectivity, how should you do the streamline tracing?</p><p>Brute force algorithm:</p><ol><li>find the grid cell you are currently in;</li><li>move along the vector direction until you hit the boundary of that cell;</li><li>find the neighbour who shares the same edge and the intersection point;</li><li>use the vector direction in the next cell and move along that direction;</li><li>repeat 2-4 until you reach any of the stopping criteria: hit the boundary, exceed <code>MaxIteration</code>, or exceed <code>MaxLength</code>.</li></ol><p>Some questions during the process:</p><ul><li>How to find the neighbouring cell?</li><li>How to determine which boundary edge will you cross?</li><li>How to improve the search speed?</li><li>How to improve accuracy?</li></ul><p>A package called <code>UnstructuredGrids.jl</code> already exists. I take advantage of this package and quickly build a 2D stream tracer on unstructured 2D grid based on the brute force algorithm.</p><p>Actually, this may not be as bad as you think in terms of accuracy. Finite volume method uses one value per cell to represent the solution space, therefore it is just cheating to use higher order method for stream tracing.</p><p>An example is shown for the 2D streamline tracing in the unstructured triangular mesh for the famous airfoil problem. The blue lines are the analytic stream functions derived from incompressible Euler equations which are calculated numerically. Three colored lines are displayed with dots representing the footprint inside each cell.</p><p><img src="../../images/trace_streamline_2Dunstructured.png" alt/></p><p>An extension to 3D is possible, and is WIP.</p><h3 id="Matlab"><a class="docs-heading-anchor" href="#Matlab">Matlab</a><a id="Matlab-1"></a><a class="docs-heading-anchor-permalink" href="#Matlab" title="Permalink"></a></h3><p>There is an implementation of streamline tracing in Matlab called tristream. It requires nodal data.</p><p>Inside the function, there is an intrinsic function called <code>pointLocation</code>, which returns the index of cell where the point locates.</p><h3 id="yt"><a class="docs-heading-anchor" href="#yt">yt</a><a id="yt-1"></a><a class="docs-heading-anchor-permalink" href="#yt" title="Permalink"></a></h3><p>There is another implementation in yt library, which has many similarities to the one I borrowed from SpacePy.</p><p>Streamlining through a volume is useful for a variety of analysis tasks. By specifying a set of starting positions, the user is returned a set of 3D positions that can, in turn, be used to visualize the 3D path of the streamlines. Additionally, individual streamlines can be converted into <code>YTStreamline</code> objects, and queried for all the available fields along the streamline.</p><p>The implementation of streamlining in yt is described below.</p><ol><li><p>Decompose the volume into a set of non-overlapping, fully domain tiling bricks, using the <code>AMRKDTree</code> homogenized volume.</p></li><li><p>For every streamline starting position:</p></li></ol><ul><li><p>While the length of the streamline is less than the requested length:</p><ol><li><p>Find the brick that contains the current position</p></li><li><p>If not already present, generate vertex-centered data for the vector fields defining the streamline.</p></li><li><p>While inside the brick</p></li><li><p>Integrate the streamline path using a Runge-Kutta 4th order method and the vertex centered data.</p></li><li><p>During the intermediate steps of each RK4 step, if the position is updated to outside the current brick, interrupt the integration and locate a new brick at the intermediate position.</p></li></ol></li></ul><ol><li>The set of streamline positions are stored in the <code>Streamlines</code> object.</li></ol><h3 id="VTK-Implementation"><a class="docs-heading-anchor" href="#VTK-Implementation">VTK Implementation</a><a id="VTK-Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#VTK-Implementation" title="Permalink"></a></h3><p>In the VTK library, there is a class called <code>vtkPointLocator</code>. It is a spatial search object to quickly locate points in 3D. <code>vtkPointLocator</code> works by dividing a specified region of space into a regular array of &quot;rectangular&quot; buckets, and then keeping a list of points that lie in each bucket. Typical operation involves giving a position in 3D and finding the closest point. It supports both nodal data and cell data.</p><p><code>vtkPointLocator</code> has two distinct methods of interaction. In the first method, you supply it with a dataset, and it operates on the points in the dataset. In the second method, you supply it with an array of points, and the object operates on the array.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Many other types of spatial locators have been developed such as octrees and kd-trees. These are often more efficient for the operations described here.</p></div></div><h2 id="Particle-Tracing"><a class="docs-heading-anchor" href="#Particle-Tracing">Particle Tracing</a><a id="Particle-Tracing-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Tracing" title="Permalink"></a></h2><p>I have a plan of incorporating particle tracing into this module. WIP</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../text/">« Text Data Processing</a><a class="docs-footer-nextpage" href="../types/">Public types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 21 July 2020 17:02">Tuesday 21 July 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
