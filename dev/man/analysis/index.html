<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data Analysis in Space Physics · VisAna</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">VisAna</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">VisAna.jl Documentation</a></li><li class="is-active"><a class="tocitem" href>Data Analysis in Space Physics</a><ul class="internal"><li><a class="tocitem" href="#Diffusion-Region-Detection-1"><span>Diffusion Region Detection</span></a></li><li><a class="tocitem" href="#Spectral-Analysis-1"><span>Spectral Analysis</span></a></li><li><a class="tocitem" href="#Minimum-Variance-Analysis-1"><span>Minimum Variance Analysis</span></a></li><li><a class="tocitem" href="#ULF-Wave-Detection-1"><span>ULF Wave Detection</span></a></li><li><a class="tocitem" href="#Correlation-Test-Between-Two-Variables-1"><span>Correlation Test Between Two Variables</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../guide/">Guide</a></li><li><a class="tocitem" href="../types/">Private types</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Data Analysis in Space Physics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Data Analysis in Space Physics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/henry2004y/VisAnaJulia/blob/master/docs/src/man/analysis.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-Analysis-in-Space-Physics-1"><a class="docs-heading-anchor" href="#Data-Analysis-in-Space-Physics-1">Data Analysis in Space Physics</a><a class="docs-heading-anchor-permalink" href="#Data-Analysis-in-Space-Physics-1" title="Permalink"></a></h1><h2 id="Diffusion-Region-Detection-1"><a class="docs-heading-anchor" href="#Diffusion-Region-Detection-1">Diffusion Region Detection</a><a class="docs-heading-anchor-permalink" href="#Diffusion-Region-Detection-1" title="Permalink"></a></h2><p>Magnetic reconnection occurs in a small diffusion region around the X-line but its consequences are large scale. There are different approaches to determine whether or not we have encountered the diffusion region. The expected kinetic signatures of diffusion region:</p><ul><li>enhanced dissipation</li><li>non-gyrotropic behavior</li><li>electron distribution functions</li></ul><p><a href="https://aip.scitation.org/doi/full/10.1063/1.4820953">A measure of non-gyrotropy</a> <span>$D_{ng}$</span> of a specific population can be think of a ratio between off-diagonal terms and diagonal terms of the pressure tensor:</p><div>\[D_{ng} = \frac{2\sqrt{\sum_{i,j}N_{i,j}^2}}{Tr(\leftrightarrow{P_s})}\]</div><p>where</p><div>\[\overleftrightarrow{P_s} = \overleftrightarrow{G} + \overleftrightarrow{N},\]</div><p><span>$\overleftrightarrow{G}$</span> is the gyrotropic term and <span>$\overleftrightarrow{N}$</span> is the nongyrotropic term. Note that this is frame dependent and population specific.</p><p>It has been found from PIC simulations that especially in asymmetric reconnection, <span>$E_M^\ast\neq 0$</span> where <span>$\mathbf{E}^\ast=\mathbf{E}+\mathbf{V}_e\times\mathbf{B}$</span> is not a good enough indicator. Following <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.106.195003#fulltext">the principle ideas of finding a measure</a>:</p><ul><li>dissipation should be related to non-ideal energy conversion;</li><li>scalar indicator;</li><li>insensitive to the relative motion,</li></ul><p>a frame independent <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.106.195003#fulltext">dissipation measure</a> is constructed,</p><div>\[D_e = \gamma_e\big[\mathbf{J}\cdot(\mathbf{E}+\mathbf{V}_e\times\mathbf{B}) - (n_i - n_e)(\mathbf{V}_e\times\mathbf{E})\big]\]</div><p>which is a Lorentz-invariant scalar representing the energy conversion rate in the frame of electron bulk motion. In the nonrelativistic limit, one can simplify the equation by setting <span>$\gamma_e\rightarrow 1$</span>. This can be easily confirmed by multiplying <span>$\mathbf{j}^\prime=qn_i\mathbf{V}_i=\mathbf{j}-\rho_c\mathbf{V}_e$</span> and <span>$\mathbf{E}^\prime = \mathbf{E}+\mathbf{V}\times\mathbf{B}$</span>.</p><p>This is another good indicator of the electron diffusion region, although slightly enhanced along the separatrices as well.</p><p><a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2016GL069034">An alternative and complementary approach</a> is to identify diffusion region candidates by a combination of representative properties. In practice for reconnection with no guide field for instance, the overlapped region of <span>$B_L=0$</span> and <span>$E_N$</span> peak, where some researchers call &#39;shoulder&#39;, is already good enough for the identification.</p><h2 id="Spectral-Analysis-1"><a class="docs-heading-anchor" href="#Spectral-Analysis-1">Spectral Analysis</a><a class="docs-heading-anchor-permalink" href="#Spectral-Analysis-1" title="Permalink"></a></h2><h3 id="FFT-1"><a class="docs-heading-anchor" href="#FFT-1">FFT</a><a class="docs-heading-anchor-permalink" href="#FFT-1" title="Permalink"></a></h3><h3 id="Periodogram-1"><a class="docs-heading-anchor" href="#Periodogram-1">Periodogram</a><a class="docs-heading-anchor-permalink" href="#Periodogram-1" title="Permalink"></a></h3><p>This is a group of techniques to determine the periodicity of data. Julia has implementations in the <a href="https://juliadsp.github.io/DSP.jl/stable/contents/">DSP</a> package. Here we introduce the usage by looking at practical examples.</p><h3 id="Spectrogram-1"><a class="docs-heading-anchor" href="#Spectrogram-1">Spectrogram</a><a class="docs-heading-anchor-permalink" href="#Spectrogram-1" title="Permalink"></a></h3><p>Spectrogram is used a lot in wave analysis. For my purpose, I use it as an approach to visualize time dependent simulation data along a continuous line region.</p><h2 id="Minimum-Variance-Analysis-1"><a class="docs-heading-anchor" href="#Minimum-Variance-Analysis-1">Minimum Variance Analysis</a><a class="docs-heading-anchor-permalink" href="#Minimum-Variance-Analysis-1" title="Permalink"></a></h2><p>A nice introduction is given by Bengt U.Ö.Sonnerup and Maureen Scheible.  Here is a brief summary of the idea. The implementation of MVA can be found in  <a href="https://github.com/henry2004y/VisAnaJulia/blob/master/src/space/MVA.jl"><code>MVA.jl</code></a>.</p><p>The main purpose of minimum or maximum variance analysis (MVA) is to find, from single-spacecraft data, an estimator for the direction normal to a one-dimensional or approximately one-dimensional current layer, wave front, or other transition layer in a plasma.</p><p>For real transition layers observed in space there are usually more or less pronounced deviations from the ideal 1-D model. The layer is likely to have 2-D or 3-D internal structures which evolve in time and to have temporal fluctuations in the orientation of its normal as well.</p><p>The minimum variance technique is designed to deal with the situation where some or all of the non-ideal effects mentioned above, except a systematic temporal change in the normal direction, <span>$\widehat{n}$</span>, are present. As the estimate of  <span>$\widehat{n}$</span>, the method identifies that direction in space along which the field-component set {<span>$\mathbf{B}^{(m)}\cdot\widehat{n}$</span>} <span>$(m = 1, 2, 3...M)$</span>  has minimum variance. In other words, <span>$\widehat{n}$</span> is determined by  minimisation of</p><div>\[\sigma^2 = \frac{1}{M} \sum_{m=1}^{M}| (\mathbf{B}^{(m)} - \mathbf{B})\cdot\widehat{n} |^2\]</div><p>where the average <span>$\langle\mathbf{B}\rangle$</span> is defined by</p><div>\[\langle\mathbf{B}\rangle \equiv \frac{1}{M} \sum_{m=1}^M \mathbf{B}^{(m)}\]</div><p>and where the minimisation is subject to the normalisation constraint <span>$|\widehat{n}|=1$</span>. Using a Lagrange multiplier <span>$\lambda$</span> to implement this constraint, one then seeks the solution of the set of three homogeneous linear equations</p><div>\[\frac{\partial}{\partial n_x}\Big( \sigma^2 - \lambda (|\widehat{n}|^2 - 1) \Big) = 0 \\
\frac{\partial}{\partial n_y}\Big( \sigma^2 - \lambda (|\widehat{n}|^2 - 1) \Big) = 0 \\
\frac{\partial}{\partial n_z}\Big( \sigma^2 - \lambda (|\widehat{n}|^2 - 1) \Big) = 0\]</div><p>where <span>$\sigma^2$</span> is given by the equation above and <span>$\widehat{n}$</span> is represented in terms of its three components <span>$(n_x, n_y, n_z)$</span> along the cartesian coordinate system X, Y, Z (e.g., GSE or GSM) in which the field data <span>$\{\mathbf{B}^{(m)} \}$</span> are given. When the differentiations in equations above have been performed, the resulting set of three equations can be written in matrix form as</p><div>\[\sum_{\nu=1}^{3} M_{\mu\nu}^{B} n_\nu = \lambda n_\mu\]</div><p>where the subscripts <span>$\mu,\nu = 1,2,3$</span> denote cartesian components along the X, Y, Z system and</p><div>\[M_{\mu\nu}^{B} \equiv \langle B_\mu B_\nu\rangle - \langle B_\mu\rangle\langle B_\nu\rangle\]</div><p>is the magnetic variance matrix. It is seen from the equation that the allowed <span>$\lambda$</span> values are the eigenvalues <span>$\lambda_1,\lambda_2,\lambda_3$</span> (given here in order of decreasing magnitude) of <span>$M_{\mu\nu}^{B}$</span>. Since <span>$M_{\mu\nu}^{B}$</span> is symmetric, the eigenvalues are all real and the corresponding eigenvectors, <span>$x_1$</span>, <span>$x_2$</span>, and <span>$x_3$</span>, are orthogonal. The three eigenvectors represent the directions of maximum, intermediate, and minimum variance of the field component along each vector.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In practice, the ratio of intermediate to minimum variance should be larger than 5 to give good fit of LMN.</p></div></div><p>A not so good example case is the Galileo G8 Ganymede flyby magnetometer data: <img src="../../images/B_Galileo_G8_LMN.png" alt/> where the ratio between the intermediate and minimum eigenvalue is only about 2.</p><h2 id="ULF-Wave-Detection-1"><a class="docs-heading-anchor" href="#ULF-Wave-Detection-1">ULF Wave Detection</a><a class="docs-heading-anchor-permalink" href="#ULF-Wave-Detection-1" title="Permalink"></a></h2><p>ULF waves are MHD waves: Alfvén wave, fast wave and slow wave. One basic approach to identify waves is to check the correlation of quantity perturbations.</p><p>The phase speed of shear Alfvén wave is</p><div>\[v_{pA} = \frac{\omega}{k} = v_A \cos{\theta}\]</div><p>where <span>$v_A$</span> is the Alfvén speed and <span>$\theta$</span> is the angle between wave vector <span>$\mathbf{k}$</span> and magnetic field <span>$\mathbf{B}$</span>.</p><p>The perturbed quantities of Alfvén waves follow these relations:</p><div>\[\frac{\delta \mathbf{v}}{v_A} = \pm \frac{\delta \mathbf{B}}{B_0} \\
\delta \rho = 0\]</div><p>where <span>$\delta \mathbf{v}$</span>, <span>$\delta \mathbf{B}$</span>, and <span>$\delta \rho$</span> are perturbed plasma velocity, magnetic fields, and plasma density, respectively, and <span>$B_0$</span> is the background magnetic magnitude.</p><p>For slow and fast waves, the phase speeds are</p><div>\[v_{p\pm}^2 = \big(\frac{\omega}{k} \big) = \frac{1}{2}(v_s^2 + v_A^2) \pm \frac{1}{2}\Big[ (v_s^2 + v_A^2)^2 - 4v_s^2 v_A^2 \cos^2{\theta}\Big]^{1/2}\]</div><p>The &quot;+&quot; is for fast waves and &quot;−&quot; for slow waves, and <span>$v_S$</span> is the sound speed. The perturbed quantities for fast and slow waves are</p><div>\[\delta \rho = \frac{\rho_0}{v_p}\frac{v_A^2\sin\theta}{B_0 (v_p - v_s^2/v_p)}\delta B\\
\delta \mathbf{v} = -\frac{v_A^2 \cos{\theta}}{B_0 v_p}\delta\mathbf{B} + \frac{v_A^2 \sin{\theta}\delta B}{B_0 (v_p - v_s^2/v_p)}\frac{\mathbf{k}}{k}\]</div><p>Thus generally the Alfvén wave is identified by the correlations between velocity and magnetic field perturbations, and the fast and slow waves are identified by the negative (for slow waves) or positive (for fast waves) correlations between either density and magnetic field perturbation or thermal pressure and magnetic pressure perturbation.</p><p>For the magnetosonic waves, consider using <span>$\delta \mathbf{E}$</span> and <span>$\delta \mathbf{B}$</span> for identifying speed. The slopes of the curves <span>$\delta E∕\delta B$</span> correspond to the wave propagation speed in the spacecraft frame.</p><p>Transverse and shear Alfvén wave refer to actually the same thing: the descriptions arise from  <span>$\mathbf{k}\cdot\mathbf{V}=0$</span> and <span>$\mathbf{V}\cdot\mathbf{B}_0=0$</span>.</p><p>The fast and slow magnetosonic waves are associated with non-zero perturbations in the plasma density and pressure, and also involve plasma motion parallel, as well as perpendicular, to the magnetic field. The latter observation suggests that the dispersion relations <span>$\omega=kV_{\pm}$</span> are likely to undergo significant modification in collisionless plasmas. In order to better understand the nature of the fast and slow waves, let us consider the cold-plasma limit, which is obtained by letting the sound speed <span>$V_S$</span> tend to zero. In this limit, the slow wave ceases to exist (in fact, its phase velocity tends to zero) whereas the dispersion relation for the fast wave reduces to</p><div>\[\omega = kV_A\]</div><p>This can be identified as the dispersion relation for the compressional-Alfvén wave. Thus, we can identify the fast wave as the compressional-Alfvén wave modified by a non-zero plasma pressure.</p><p>In the limit <span>$V_A\gg V_S$</span>, which is appropriate to low-<span>$\beta$</span> plasmas, the dispersion relation for the slow wave reduces to</p><div>\[\omega \simeq k\,V_S\,\cos\theta.\]</div><p>This is actually the dispersion relation of a sound wave propagating along magnetic field-lines. Thus, in low-<span>$\beta$</span> plasmas the slow wave is a sound wave modified by the presence of the magnetic field.</p><p>In reality, waves can be mixed together with mode conversions. Also, notice that the classical wave theory is based on spatially homogeneous plasma assumption, which is rarely the case in nature such as the magnetosphere.</p><p>A tricky part in practice is how to get the average through smoothing. Note that a real satellite moves both in time and space. Usually people do moving-box-average to get an average state within a short period.</p><p>A more careful analysis is called Walen test.</p><p>However, always keep in mind that the most reliable way of identifying waves is to calculate the dispersion relation.</p><h2 id="Correlation-Test-Between-Two-Variables-1"><a class="docs-heading-anchor" href="#Correlation-Test-Between-Two-Variables-1">Correlation Test Between Two Variables</a><a class="docs-heading-anchor-permalink" href="#Correlation-Test-Between-Two-Variables-1" title="Permalink"></a></h2><p>This part takes the reference from <a href="http://www.sthda.com/english/wiki/correlation-test-between-two-variables-in-r">R</a>.</p><p>Correlation test is used to evaluate the association between two or more variables.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>If there is no relationship between the two variables, the average of <span>$x$</span> should be the same regardless of <span>$y$</span> and vice versa.</p></div></div><h3 id="Methods-for-correlation-analyses-1"><a class="docs-heading-anchor" href="#Methods-for-correlation-analyses-1">Methods for correlation analyses</a><a class="docs-heading-anchor-permalink" href="#Methods-for-correlation-analyses-1" title="Permalink"></a></h3><p>There are different methods to perform correlation analysis:</p><ul><li>Pearson correlation (r), which measures a linear dependence between two variables (x and y). It’s also known as a parametric correlation test because it depends to the distribution of the data. It can be used only when x and y are from normal distribution. The plot of y = f(x) is named the linear regression curve.</li><li>Kendall tau and Spearman rho, which are rank-based correlation coefficients (non-parametric).</li></ul><h3 id="Correlation-formula-1"><a class="docs-heading-anchor" href="#Correlation-formula-1">Correlation formula</a><a class="docs-heading-anchor-permalink" href="#Correlation-formula-1" title="Permalink"></a></h3><p>In the formula below,</p><ul><li>x and y are two vectors of length n</li><li><span>$\bar{x}$</span> and <span>$\bar{y}$</span> corresponds to the means of <span>$x$</span> and <span>$y$</span>, respectively.</li></ul><p>Pearson correlation formula</p><div>\[r = \frac{\sum (x-\bar{x})(y-\bar{y}}{\sqrt{\sum(x-\bar{x})^2\sum(y-\bar{y})^2}}\]</div><p>The p-value (significance level) of the correlation can be determined :</p><ol><li>by using the correlation coefficient table for the degrees of freedom : <span>$df=n−2$</span>, where <span>$n$</span> is the number of observation in <span>$x$</span> and <span>$y$</span> variables.</li></ol><p>2 or by calculating the <span>$t$</span> value as follows:</p><div>\[t = \frac{|r|}{\sqrt{1-r^2}}\sqrt{n-2}\]</div><p>where the corresponding p-value is determined using t table distribution for <span>$df=n-2$</span>. If the p-value is <span>$&lt; 5\%$</span>, then the correlation between <span>$x$</span> and <span>$y$</span> is significant.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« VisAna.jl Documentation</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 15 February 2020 03:49">Saturday 15 February 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
